import os
import logging
from typing import List, Optional
from dotenv import load_dotenv

# –ó–∞–≥—Ä—É–∑–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
load_dotenv()

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    level=logging.INFO
)
logger = logging.getLogger(__name__)

class Config:
    """–ö–ª–∞—Å—Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è"""
    
    # ===== –û–°–ù–û–í–ù–´–ï –ù–ê–°–¢–†–û–ô–ö–ò =====
    
    # Telegram Bot Token
    TELEGRAM_TOKEN: str = os.getenv("TELEGRAM_TOKEN", "")
    
    # ===== AI –ü–†–û–í–ê–ô–î–ï–†–´ =====
    AI_PROVIDER: str = os.getenv("AI_PROVIDER", "yandex")  # yandex, openai, local

    # Yandex GPT
    YANDEX_API_KEY: str = os.getenv("YANDEX_API_KEY", "")
    YANDEX_FOLDER_ID: str = os.getenv("YANDEX_FOLDER_ID", "")
    YANDEX_MODEL: str = "yandexgpt-lite"  # –ò–°–ü–†–ê–í–õ–ï–ù–û: –±—ã–ª–æ "yandexgpt-late"
    YANDEX_URL: str = "https://llm.api.cloud.yandex.net/foundationModels/v1/completion"
    
    # OpenAI API Key (—Ä–µ–∑–µ—Ä–≤–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç)
    OPENAI_API_KEY: str = os.getenv("OPENAI_API_KEY", "")
    
    # Database
    DATABASE_URL: str = os.getenv("DATABASE_URL", "sqlite:///chat_data.db")
    
    # ===== –ù–ê–°–¢–†–û–ô–ö–ò –ü–û –£–ú–û–õ–ß–ê–ù–ò–Æ =====
    
    # –í—Ä–µ–º—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏–∏
    DEFAULT_SUMMARY_TIME: str = "21:00"
    
    # –í–∫–ª—é—á–µ–Ω–∞ –ª–∏ –µ–∂–µ–¥–Ω–µ–≤–Ω–∞—è —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
    DEFAULT_SUMMARY_ENABLED: bool = True
    
    # –ó–∞–∫—Ä–µ–ø–ª—è—Ç—å –ª–∏ —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—é –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
    DEFAULT_PIN_SUMMARY: bool = True
    
    # ===== –ù–ê–°–¢–†–û–ô–ö–ò AI –ú–û–î–ï–õ–ï–ô =====
    
    # –ú–æ–¥–µ–ª—å AI –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
    AI_MODEL: str = "gpt-3.5-turbo"  # –¥–ª—è OpenAI
    
    # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–∫–µ–Ω–æ–≤ –≤ –æ—Ç–≤–µ—Ç–µ
    AI_MAX_TOKENS: int = 1000
    
    # –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ (0-1)
    AI_TEMPERATURE: float = 0.7
    
    # –ú–æ–¥–µ–ª—å –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –≥–æ–ª–æ—Å–∞
    WHISPER_MODEL: str = "whisper-1"
    
    # –ú–æ–¥–µ–ª—å –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
    VISION_MODEL: str = "gpt-4-vision-preview"
    
    # ===== –õ–ò–ú–ò–¢–´ –°–û–û–ë–©–ï–ù–ò–ô =====
    
    # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
    MAX_MESSAGES_FOR_ANALYSIS: int = 200
    
    # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–æ–±—â–µ–Ω–∏–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è –∫–æ–º–∞–Ω–¥
    DEFAULT_MESSAGE_LIMIT: int = 50
    
    # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ç–µ–º
    THEMES_MAX_MESSAGES: int = 100
    
    # –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ —Ç–µ–∫—Å—Ç–∞ –¥–ª—è –∫–æ–º–∞–Ω–¥—ã /brief
    BRIEF_MIN_LENGTH: int = 100
    
    # ===== –ù–ê–°–¢–†–û–ô–ö–ò –í–û–ü–†–û–°–û–í =====
    
    # –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –≤–æ–ø—Ä–æ—Å–∞
    MIN_QUESTION_LENGTH: int = 3
    
    # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –≤–æ–ø—Ä–æ—Å–∞
    MAX_QUESTION_LENGTH: int = 1000
    
    # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è /ask
    ASK_MAX_MESSAGES: int = 100
    
    # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–∫–µ–Ω–æ–≤ –¥–ª—è /gpt
    GPT_MAX_TOKENS: int = 1200
    
    # ===== –ù–ê–°–¢–†–û–ô–ö–ò –ê–ù–ê–õ–ò–ó–ê =====
    
    # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–æ–±—â–µ–Ω–∏–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è /opinion
    OPINION_DEFAULT_MESSAGES: int = 100
    
    # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è /opinion
    OPINION_MAX_MESSAGES: int = 500
    
    # –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è /opinion
    OPINION_MIN_MESSAGES: int = 10
    
    # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è /comment
    COMMENT_MESSAGE_LIMIT: int = 30
    
    # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–∫–µ–Ω–æ–≤ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
    ANALYSIS_MAX_TOKENS: int = 1000
    
    # –†–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ —Ç–∏–ø—ã –∞–Ω–∞–ª–∏–∑–∞
    ALLOWED_ANALYSIS_TYPES: List[str] = ["communication_style", "topics", "behavior_patterns"]
    
    # ===== –ù–ê–°–¢–†–û–ô–ö–ò –£–¢–ò–õ–ò–¢ =====
    
    # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –ª–∏—á–Ω–æ—Å—Ç–∏ –±–æ—Ç–∞
    MAX_PERSONALITY_LENGTH: int = 500
    
    # –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ç–∏–ø—ã –º–µ–¥–∏–∞
    SUPPORTED_MEDIA_TYPES: List[str] = ['voice', 'photo', 'document']
    
    # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è (–≤ —Å–µ–∫—É–Ω–¥–∞—Ö)
    MAX_VOICE_DURATION: int = 300  # 5 –º–∏–Ω—É—Ç
    
    # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–≤ –±–∞–π—Ç–∞—Ö)
    MAX_IMAGE_SIZE: int = 20 * 1024 * 1024  # 20MB
    
    # –ò–Ω—Ç–µ—Ä–≤–∞–ª –æ—á–∏—Å—Ç–∫–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ (–≤ —Å–µ–∫—É–Ω–¥–∞—Ö)
    TEMP_FILE_CLEANUP_INTERVAL: int = 3600  # 1 —á–∞—Å
    
    # ===== –ù–ê–°–¢–†–û–ô–ö–ò –ë–ê–ó–´ –î–ê–ù–ù–´–• =====
    
    # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
    DATABASE_BACKUP_DAYS: int = 7
    MESSAGE_RETENTION_DAYS: int = 90
    CLEANUP_INTERVAL_HOURS: int = 24
    
    # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
    STATS_DEFAULT_DAYS: int = 30
    MAX_STATS_DAYS: int = 365
    
    # ===== –ü–†–û–ú–ü–¢–´ –î–õ–Ø AI =====
    
    # –°–∏—Å—Ç–µ–º–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
    SUMMARY_SYSTEM_PROMPT: str = (
        "–¢—ã - –ø–æ–º–æ—â–Ω–∏–∫ –¥–ª—è —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏–∏ –≥—Ä—É–ø–ø–æ–≤—ã—Ö —á–∞—Ç–æ–≤. "
        "–°–æ–∑–¥–∞–π –∫—Ä–∞—Ç–∫–æ–µ, –Ω–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –æ–±—Å—É–∂–¥–µ–Ω–∏—è."
    )
    
    THEMES_SYSTEM_PROMPT: str = (
        "–¢—ã –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—à—å –≥—Ä—É–ø–ø–æ–≤—ã–µ —á–∞—Ç—ã –∏ –≤—ã–¥–µ–ª—è–µ—à—å –æ—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ–º—ã –æ–±—Å—É–∂–¥–µ–Ω–∏—è. "
        "–ë—É–¥—å —Ç–æ—á–Ω—ã–º –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º."
    )
    
    BRIEF_SYSTEM_PROMPT: str = (
        "–¢—ã - —ç–∫—Å–ø–µ—Ä—Ç –ø–æ —Å–æ–∑–¥–∞–Ω–∏—é –∫—Ä–∞—Ç–∫–∏—Ö –∏–∑–ª–æ–∂–µ–Ω–∏–π. "
        "–°–æ–∫—Ä–∞—â–∞–π –¥–ª–∏–Ω–Ω—ã–µ —Ç–µ–∫—Å—Ç—ã, —Å–æ—Ö—Ä–∞–Ω—è—è –∫–ª—é—á–µ–≤—ã–µ –∏–¥–µ–∏ –∏ —Å–º—ã—Å–ª."
    )
    
    ASK_SYSTEM_PROMPT: str = (
        "–¢—ã - –ø–æ–º–æ—â–Ω–∏–∫, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏—Å—Ç–æ—Ä–∏–∏ –≥—Ä—É–ø–ø–æ–≤–æ–≥–æ —á–∞—Ç–∞. "
        "–¢–≤–æ—è –∑–∞–¥–∞—á–∞ - –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –∏ –¥–∞–≤–∞—Ç—å —Ç–æ—á–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã. "
        "–ï—Å–ª–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≤ —Å–æ–æ–±—â–µ–Ω–∏—è—Ö –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ, —á–µ—Å—Ç–Ω–æ –≥–æ–≤–æ—Ä–∏ –æ–± —ç—Ç–æ–º."
    )
    
    GPT_SYSTEM_PROMPT: str = (
        "–¢—ã - –ø–æ–ª–µ–∑–Ω—ã–π AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç. –û—Ç–≤–µ—á–∞–π –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –ø–æ–¥—Ä–æ–±–Ω–æ, —Ç–æ—á–Ω–æ –∏ –ø–æ–ª–µ–∑–Ω–æ. "
        "–ò—Å–ø–æ–ª—å–∑—É–π —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–Ω–∞–Ω–∏—è –∏ –ª—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏."
    )
    
    OPINION_SYSTEM_PROMPT: str = (
        "–¢—ã - —ç–∫—Å–ø–µ—Ä—Ç –ø–æ –∞–Ω–∞–ª–∏–∑—É –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏ –∏ –ø–æ–≤–µ–¥–µ–Ω–∏—è –≤ –≥—Ä—É–ø–ø–æ–≤—ã—Ö —á–∞—Ç–∞—Ö. "
        "–¢–≤–æ—è –∑–∞–¥–∞—á–∞ - –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∏–ª—å –æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π. "
        "–ë—É–¥—å –æ–±—ä–µ–∫—Ç–∏–≤–Ω—ã–º, —Ç–∞–∫—Ç–∏—á–Ω—ã–º –∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–º."
    )
    
    COMMENT_SYSTEM_PROMPT: str = (
        "–¢—ã - —ç–∫—Å–ø–µ—Ä—Ç –ø–æ –∞–Ω–∞–ª–∏–∑—É –≥—Ä—É–ø–ø–æ–≤—ã—Ö –¥–∏—Å–∫—É—Å—Å–∏–π. "
        "–¢–≤–æ—è –∑–∞–¥–∞—á–∞ - –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—É—â–µ–µ –æ–±—Å—É–∂–¥–µ–Ω–∏–µ –≤ —á–∞—Ç–µ –∏ –¥–∞–≤–∞—Ç—å "
        "–ø–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏, insights –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ —Ä–∞–∑–≤–∏—Ç–∏—é —Ç–µ–º—ã."
    )
    
    # ===== –®–ê–ë–õ–û–ù–´ –û–¢–í–ï–¢–û–í =====
    
    ASK_RESPONSE_TEMPLATE: str = (
        "üîç **–í–æ–ø—Ä–æ—Å:** {question}\n\n"
        "**üìä –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–π:** {count}\n\n"
        "**üí° –û—Ç–≤–µ—Ç:**\n{answer}"
    )
    
    GPT_RESPONSE_TEMPLATE: str = (
        "ü§ñ **–í–æ–ø—Ä–æ—Å:** {question}\n\n"
        "**üí≠ –û—Ç–≤–µ—Ç Yandex GPT:**\n{answer}\n\n"
        "---\n"
        "*–û—Ç–≤–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω Yandex GPT*"
    )
    
    OPINION_RESPONSE_TEMPLATE: str = (
        "üë§ **–ê–Ω–∞–ª–∏–∑ —Å—Ç–∏–ª—è –æ–±—â–µ–Ω–∏—è:** @{username}\n\n"
        "**üìä –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–π:** {count}\n\n"
        "**üîç –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞:**\n{analysis}\n\n"
        "---\n"
        "*–ê–Ω–∞–ª–∏–∑ –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ –∏—Å—Ç–æ—Ä–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –æ—Ç—Ä–∞–∂–∞–µ—Ç —Å—Ç–∏–ª—å –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏, –∞ –Ω–µ –ª–∏—á–Ω–æ—Å—Ç–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏.*"
    )
    
    COMMENT_RESPONSE_TEMPLATE: str = (
        "üí¨ **–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ —Ç–µ–∫—É—â–µ–º—É –æ–±—Å—É–∂–¥–µ–Ω–∏—é:**\n\n{comment}\n\n"
        "---\n"
        "*–ê–Ω–∞–ª–∏–∑ –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏—è—Ö —á–∞—Ç–∞.*"
    )
    
    EXTRACTED_TEXT_TEMPLATE: str = (
        "üìù **–¢–µ–∫—Å—Ç –∏–∑ {media_type}:**\n\n{text}\n\n"
        "---\n"
        "*–¢–µ–∫—Å—Ç –∏–∑–≤–ª–µ—á–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏. –¢–æ—á–Ω–æ—Å—Ç—å –º–æ–∂–µ—Ç –≤–∞—Ä—å–∏—Ä–æ–≤–∞—Ç—å—Å—è.*"
    )
    
    # ===== –ú–ï–¢–û–î–´ –í–ê–õ–ò–î–ê–¶–ò–ò =====
    
    def validate_config(self):
        """–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö"""
        errors = []
        
        if not self.TELEGRAM_TOKEN:
            errors.append("TELEGRAM_TOKEN –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω")
        
        if self.AI_PROVIDER == "yandex":
            if not self.YANDEX_API_KEY:
                errors.append("YANDEX_API_KEY –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –¥–ª—è Yandex GPT")
            if not self.YANDEX_FOLDER_ID:
                errors.append("YANDEX_FOLDER_ID –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω")
        elif self.AI_PROVIDER == "openai":
            if not self.OPENAI_API_KEY:
                errors.append("OPENAI_API_KEY –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –¥–ª—è OpenAI")
        # –î–ª—è "local" –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è API –∫–ª—é—á–µ–π
        
        if errors:
            error_message = "–û—à–∏–±–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:\n- " + "\n- ".join(errors)
            logger.error(error_message)
            raise ValueError(error_message)
        
        logger.info(f"–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ–≤–µ—Ä–µ–Ω–∞. AI –ø—Ä–æ–≤–∞–π–¥–µ—Ä: {self.AI_PROVIDER}")
    
    def get_supported_models(self) -> List[str]:
        """–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö –º–æ–¥–µ–ª–µ–π"""
        if self.AI_PROVIDER == "yandex":
            return [
                "yandexgpt-lite",
                "yandexgpt"
            ]
        else:
            return [
                "gpt-3.5-turbo",
                "gpt-4",
                "gpt-4-turbo-preview",
                "gpt-4-vision-preview"
            ]
    
    def get_limits_info(self) -> str:
        """–ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ª–∏–º–∏—Ç–∞—Ö –≤ —á–∏—Ç–∞–µ–º–æ–º —Ñ–æ—Ä–º–∞—Ç–µ"""
        provider_info = "Yandex GPT" if self.AI_PROVIDER == "yandex" else "OpenAI GPT"
        
        return f"""
üìä **–õ–∏–º–∏—Ç—ã —Å–∏—Å—Ç–µ–º—ã:**

‚Ä¢ AI –ø—Ä–æ–≤–∞–π–¥–µ—Ä: {provider_info}
‚Ä¢ –°–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞: –¥–æ {self.MAX_MESSAGES_FOR_ANALYSIS}
‚Ä¢ –ê–Ω–∞–ª–∏–∑ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: {self.OPINION_MIN_MESSAGES}-{self.OPINION_MAX_MESSAGES} —Å–æ–æ–±—â–µ–Ω–∏–π
‚Ä¢ –î–ª–∏–Ω–∞ –≤–æ–ø—Ä–æ—Å–∞: {self.MIN_QUESTION_LENGTH}-{self.MAX_QUESTION_LENGTH} —Å–∏–º–≤–æ–ª–æ–≤
‚Ä¢ –ì–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è: –¥–æ {self.MAX_VOICE_DURATION // 60} –º–∏–Ω—É—Ç
‚Ä¢ –õ–∏—á–Ω–æ—Å—Ç—å –±–æ—Ç–∞: –¥–æ {self.MAX_PERSONALITY_LENGTH} —Å–∏–º–≤–æ–ª–æ–≤
‚Ä¢ –•—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π: {self.MESSAGE_RETENTION_DAYS} –¥–Ω–µ–π
        """.strip()
    
    def get_ai_provider_info(self) -> str:
        """–ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–µ–∫—É—â–µ–º AI –ø—Ä–æ–≤–∞–π–¥–µ—Ä–µ"""
        if self.AI_PROVIDER == "yandex":
            return "ü§ñ Yandex GPT (–†—É—Å—Å–∫–∏–π —è–∑—ã–∫)"
        elif self.AI_PROVIDER == "openai":
            return "ü§ñ OpenAI GPT"
        else:
            return "ü§ñ –õ–æ–∫–∞–ª—å–Ω—ã–π —Ä–µ–∂–∏–º (–±–∞–∑–æ–≤—ã–µ –æ—Ç–≤–µ—Ç—ã)"

# –°–æ–∑–¥–∞–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
config = Config()

# –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
TELEGRAM_TOKEN = config.TELEGRAM_TOKEN
OPENAI_API_KEY = config.OPENAI_API_KEY
DATABASE_URL = config.DATABASE_URL

# –í–∞–ª–∏–¥–∏—Ä—É–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ
try:
    config.validate_config()
except ValueError as e:
    logger.error(f"Configuration error: {e}")
    # –ù–µ –ø–∞–¥–∞–µ–º –∑–¥–µ—Å—å, —á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é